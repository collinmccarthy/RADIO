[07/18 18:20:19 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------
[07/18 18:20:19 generate_version_kwargs.py INFO] Radio Version: radio_v2.1, Model: vit_huge_patch16_224_mlpnorm, Num Params: 651.98M, Verification: SUCCESS
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Resource kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'url': 'https://huggingface.co/nvidia/RADIO/resolve/main/radio_v2.1_bf16.pth.tar?download=true',
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': {'height': 432, 'width': 432}}
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Conditioner kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'input_scale': 1.0,
 'norm_mean': (0.48145466, 0.4578275, 0.40821073),
 'norm_std': (0.26862954, 0.26130258, 0.27577711),
 'dtype': torch.bfloat16}
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Create model kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'model': 'vit_huge_patch16_224_mlpnorm',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 2048,
 'model_kwargs': {},
 'num_teachers': 4,
 'register_multiple': 16,
 'spectral_reparam': False,
 'model_norm': True}
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Radio kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'input_conditioner': InputConditioner(),
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=432, width=432),
 'summary_idxs': tensor([0, 1, 2, 3]),
 'window_size': None,
 'adaptors': {}}
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Create radio kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=432, width=432),
 'adaptor_cfgs': None,
 'vitdet_window_size': None,
 'model': 'vit_huge_patch16_224_mlpnorm',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 2048,
 'model_kwargs': {},
 'teachers': [{'type': 'open_clip',
               'name': 'clip',
               'model': 'ViT-H-14-378-quickgelu',
               'pretrained': 'dfn5b',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 378},
              {'type': 'openai_clip',
               'name': 'openai_clip',
               'model': 'ViT-L/14@336px',
               'pretrained': 'openai',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 336},
              {'type': 'dino_v2',
               'name': 'dino_v2',
               'model': 'dinov2_vitg14_reg',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 378},
              {'type': 'sam',
               'name': 'sam',
               'model': 'vit-h',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 1024}],
 'register_multiple': 16,
 'spectral_reparam': False,
 'model_norm': True,
 'dtype': torch.bfloat16,
 'disable_spectral_reparam': True}
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] Full checkpoint kwargs
[07/18 18:20:19 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:19 generate_version_kwargs.py INFO] 
{'aa': None,
 'amp': False,
 'amp_dtype': 'float16',
 'amp_impl': 'native',
 'aug_repeats': 0,
 'aug_splits': 0,
 'bn_eps': None,
 'bn_momentum': None,
 'cache_dir': None,
 'channels_last': False,
 'checkpoint_hist': 10,
 'chk_keep_forever': 10,
 'class_map': '',
 'clip_grad': None,
 'clip_mode': 'norm',
 'cls_token_per_teacher': True,
 'coco_annotations_file': '/datasets/coco2017-adlsa/annotations/captions_val2017.json',
 'coco_image_dir': '/datasets/coco2017-adlsa/val2017',
 'color_jitter': 0.4,
 'cooldown_epochs': 0,
 'cpe_max_size': 2048,
 'crd_loss': False,
 'crd_loss_weight': 0.8,
 'crop_pct': None,
 'cutmix': 0.0,
 'cutmix_minmax': None,
 'dataset_download': False,
 'debug_full_knn': False,
 'decay_epochs': 90,
 'decay_milestones': [90, 180, 270],
 'decay_rate': 0.1,
 'device': 'cuda:0',
 'dist_bn': 'reduce',
 'distributed': True,
 'drop': 0.0,
 'drop_block': None,
 'drop_connect': None,
 'drop_path': None,
 'dtype': torch.bfloat16,
 'epoch_repeats': 0.0,
 'eval': False,
 'eval_metric': 'knn_top1',
 'eval_teacher': False,
 'eval_teacher_only': False,
 'eval_throughput': False,
 'fast_norm': False,
 'feature_summarizer': 'cls_token',
 'feature_upscale_factor': None,
 'force_new_wandb_id': False,
 'force_spectral_reparam': False,
 'fuser': '',
 'gp': None,
 'grad_accum_steps': 1,
 'grad_checkpointing': False,
 'head_init_bias': None,
 'head_init_scale': None,
 'hflip': 0.5,
 'img_size': None,
 'in_chans': None,
 'initial_checkpoint': '',
 'input_size': None,
 'interpolation': '',
 'layer_decay': None,
 'local_rank': 0,
 'log_interval': 50,
 'log_mlflow': False,
 'log_wandb': True,
 'loss_auto_balance': False,
 'lr_base': 0.1,
 'lr_base_scale': '',
 'lr_base_size': 256,
 'lr_cycle_decay': 0.5,
 'lr_cycle_limit': 1,
 'lr_cycle_mul': 1.0,
 'lr_k_decay': 1.0,
 'lr_noise': None,
 'lr_noise_pct': 0.67,
 'lr_noise_std': 1.0,
 'mean': None,
 'mesa': {'gaussian_kl': False, 'start_epoch': 100},
 'min_lr': 0,
 'mixup': 0.0,
 'mixup_mode': 'batch',
 'mixup_off_epoch': 0,
 'mixup_prob': 1.0,
 'mixup_switch_prob': 0.5,
 'mlp_hidden_size': 1520,
 'mlp_num_inner': 3,
 'mlp_version': 'v2',
 'model': 'vit_huge_patch16_224_mlpnorm',
 'model_kwargs': {},
 'model_norm': True,
 'momentum': 0.9,
 'no_aug': False,
 'no_ddp_bb': False,
 'no_prefetcher': False,
 'no_resume_opt': False,
 'num_classes': None,
 'opt_betas': None,
 'opt_eps': None,
 'patience_epochs': 10,
 'pin_mem': False,
 'prefetcher': True,
 'pretrained': False,
 'rank': 0,
 'ratio': [0.75, 1.3333333333333333],
 'recount': 1,
 'recovery_interval': 0,
 'register_multiple': 16,
 'remode': 'pixel',
 'reprob': 0.0,
 'resplit': False,
 'save_images': False,
 'scale': [0.5, 1.0],
 'sched': 'cosine',
 'seed': 42,
 'smoothing': 0.1,
 'spectral_reparam': False,
 'split_bn': False,
 'start_epoch': None,
 'std': None,
 'sync_bn': False,
 'synchronize_step': True,
 'teachers': [{'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 378,
               'model': 'ViT-H-14-378-quickgelu',
               'name': 'clip',
               'pretrained': 'dfn5b',
               'type': 'open_clip'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 336,
               'model': 'ViT-L/14@336px',
               'name': 'openai_clip',
               'pretrained': 'openai',
               'type': 'openai_clip'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 378,
               'model': 'dinov2_vitg14_reg',
               'name': 'dino_v2',
               'type': 'dino_v2'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 1024,
               'model': 'vit-h',
               'name': 'sam',
               'type': 'sam'}],
 'torchcompile': None,
 'torchscript': False,
 'train_interpolation': 'random',
 'train_split': 'train',
 'tta': 0,
 'use_coco': False,
 'use_multi_epochs_loader': False,
 'val_ema_only': False,
 'val_split': 'val',
 'vflip': 0.0,
 'wandb_entity': '',
 'wandb_job_type': '',
 'wandb_name': '',
 'wandb_project': '',
 'warmup_lr': 1e-05,
 'warmup_prefix': False,
 'worker_seeding': 'all',
 'workers': 8,
 'world_size': 128}
[07/18 18:20:19 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------

[07/18 18:20:57 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------
[07/18 18:20:57 generate_version_kwargs.py INFO] Radio Version: radio_v2, Model: vit_huge_patch16_224_mlpnorm, Num Params: 651.98M, Verification: SUCCESS
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Resource kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'url': 'https://huggingface.co/nvidia/RADIO/resolve/main/radio_v2.pth.tar?download=true',
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': {'height': 432, 'width': 432}}
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Conditioner kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'input_scale': 1.0,
 'norm_mean': (0.48145466, 0.4578275, 0.40821073),
 'norm_std': (0.26862954, 0.26130258, 0.27577711),
 'dtype': torch.float32}
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Create model kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'model': 'vit_huge_patch16_224_mlpnorm',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 2048,
 'model_kwargs': {},
 'num_teachers': 4,
 'register_multiple': 16,
 'spectral_reparam': False,
 'model_norm': True}
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Radio kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'input_conditioner': InputConditioner(),
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=432, width=432),
 'summary_idxs': tensor([0, 1, 2, 3]),
 'window_size': None,
 'adaptors': {}}
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Create radio kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=432, width=432),
 'adaptor_cfgs': None,
 'vitdet_window_size': None,
 'model': 'vit_huge_patch16_224_mlpnorm',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 2048,
 'model_kwargs': {},
 'teachers': [{'type': 'open_clip',
               'name': 'clip',
               'model': 'ViT-H-14-378-quickgelu',
               'pretrained': 'dfn5b',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 378},
              {'type': 'openai_clip',
               'name': 'openai_clip',
               'model': 'ViT-L/14@336px',
               'pretrained': 'openai',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 336},
              {'type': 'dino_v2',
               'name': 'dino_v2',
               'model': 'dinov2_vitg14_reg',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 224},
              {'type': 'sam',
               'name': 'sam',
               'model': 'vit-h',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 1024}],
 'register_multiple': 16,
 'spectral_reparam': False,
 'model_norm': True,
 'dtype': torch.float32,
 'disable_spectral_reparam': True}
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] Full checkpoint kwargs
[07/18 18:20:57 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:20:57 generate_version_kwargs.py INFO] 
{'aa': None,
 'amp': True,
 'amp_dtype': 'bfloat16',
 'amp_impl': 'native',
 'aug_repeats': 0,
 'aug_splits': 0,
 'bn_eps': None,
 'bn_momentum': None,
 'cache_dir': None,
 'channels_last': False,
 'checkpoint_hist': 10,
 'class_map': '',
 'clip_grad': None,
 'clip_mode': 'norm',
 'cls_token_per_teacher': True,
 'coco_annotations_file': '/datasets/coco2017-adlsa/annotations/captions_val2017.json',
 'coco_image_dir': '/datasets/coco2017-adlsa/val2017',
 'color_jitter': 0.4,
 'cooldown_epochs': 0,
 'cpe_max_size': 2048,
 'crd_loss': False,
 'crd_loss_weight': 0.8,
 'crop_pct': None,
 'cutmix': 0.0,
 'cutmix_minmax': None,
 'dataset_download': False,
 'debug_full_knn': False,
 'decay_epochs': 90,
 'decay_milestones': [90, 180, 270],
 'decay_rate': 0.1,
 'device': 'cuda:0',
 'dist_bn': 'reduce',
 'distributed': True,
 'drop': 0.0,
 'drop_block': None,
 'drop_connect': None,
 'drop_path': None,
 'epoch_repeats': 0.0,
 'eval': False,
 'eval_metric': 'knn_top1',
 'eval_teacher': False,
 'eval_teacher_only': False,
 'eval_throughput': False,
 'fast_norm': False,
 'feature_summarizer': 'cls_token',
 'feature_upscale_factor': None,
 'force_new_wandb_id': False,
 'force_spectral_reparam': False,
 'fuser': '',
 'gp': None,
 'grad_accum_steps': 1,
 'grad_checkpointing': False,
 'head_init_bias': None,
 'head_init_scale': None,
 'hflip': 0.5,
 'img_size': None,
 'in_chans': None,
 'initial_checkpoint': '',
 'input_size': None,
 'interpolation': '',
 'layer_decay': None,
 'local_rank': 0,
 'log_interval': 50,
 'log_mlflow': False,
 'log_wandb': True,
 'loss_auto_balance': False,
 'lr_base': 0.1,
 'lr_base_scale': '',
 'lr_base_size': 256,
 'lr_cycle_decay': 0.5,
 'lr_cycle_limit': 1,
 'lr_cycle_mul': 1.0,
 'lr_k_decay': 1.0,
 'lr_noise': None,
 'lr_noise_pct': 0.67,
 'lr_noise_std': 1.0,
 'mean': None,
 'mesa': {'gaussian_kl': False, 'start_epoch': 250},
 'min_lr': 0,
 'mixup': 0.0,
 'mixup_mode': 'batch',
 'mixup_off_epoch': 0,
 'mixup_prob': 1.0,
 'mixup_switch_prob': 0.5,
 'mlp_hidden_size': 1520,
 'mlp_num_inner': 3,
 'mlp_version': 'v2',
 'model': 'vit_huge_patch16_224_mlpnorm',
 'model_kwargs': {},
 'model_norm': True,
 'momentum': 0.9,
 'no_aug': False,
 'no_ddp_bb': False,
 'no_prefetcher': False,
 'no_resume_opt': False,
 'num_classes': None,
 'opt_betas': None,
 'opt_eps': None,
 'patience_epochs': 10,
 'pin_mem': False,
 'prefetcher': True,
 'pretrained': False,
 'rank': 0,
 'ratio': [0.75, 1.3333333333333333],
 'recount': 1,
 'recovery_interval': 0,
 'register_multiple': 16,
 'remode': 'pixel',
 'reprob': 0.0,
 'resplit': False,
 'save_images': False,
 'scale': [0.5, 1.0],
 'sched': 'cosine',
 'seed': 42,
 'smoothing': 0.1,
 'spectral_reparam': False,
 'split_bn': False,
 'start_epoch': None,
 'std': None,
 'sync_bn': False,
 'synchronize_step': False,
 'teachers': [{'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 378,
               'model': 'ViT-H-14-378-quickgelu',
               'name': 'clip',
               'pretrained': 'dfn5b',
               'type': 'open_clip'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 336,
               'model': 'ViT-L/14@336px',
               'name': 'openai_clip',
               'pretrained': 'openai',
               'type': 'openai_clip'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 224,
               'model': 'dinov2_vitg14_reg',
               'name': 'dino_v2',
               'type': 'dino_v2'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 1024,
               'model': 'vit-h',
               'name': 'sam',
               'type': 'sam'}],
 'torchcompile': None,
 'torchscript': False,
 'train_interpolation': 'random',
 'train_split': 'train',
 'tta': 0,
 'use_coco': False,
 'use_multi_epochs_loader': False,
 'val_split': 'val',
 'vflip': 0.0,
 'wandb_entity': '',
 'wandb_job_type': '',
 'wandb_name': '',
 'wandb_project': '',
 'warmup_lr': 1e-05,
 'warmup_prefix': False,
 'worker_seeding': 'all',
 'workers': 8,
 'world_size': 128}
[07/18 18:20:57 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------

[07/18 18:21:41 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------
[07/18 18:21:41 generate_version_kwargs.py INFO] Radio Version: radio_v1, Model: vit_huge_patch14_224, Num Params: 637.64M, Verification: SUCCESS
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Resource kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'url': 'https://huggingface.co/nvidia/RADIO/resolve/main/radio_v1.pth.tar?download=true',
 'patch_size': 14,
 'max_resolution': 1050,
 'preferred_resolution': {'height': 378, 'width': 378}}
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Conditioner kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'input_scale': 1.0,
 'norm_mean': (0.48145466, 0.4578275, 0.40821073),
 'norm_std': (0.26862954, 0.26130258, 0.27577711),
 'dtype': torch.float32}
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Create model kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'model': 'vit_huge_patch14_224',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': 'avg',
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 1050,
 'model_kwargs': {},
 'num_teachers': 3,
 'register_multiple': 8,
 'spectral_reparam': False,
 'model_norm': False}
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Radio kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'input_conditioner': InputConditioner(),
 'patch_size': 14,
 'max_resolution': 1050,
 'preferred_resolution': Resolution(height=378, width=378),
 'summary_idxs': tensor([0, 2]),
 'window_size': None,
 'adaptors': {}}
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Create radio kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'patch_size': 14,
 'max_resolution': 1050,
 'preferred_resolution': Resolution(height=378, width=378),
 'adaptor_cfgs': None,
 'vitdet_window_size': None,
 'model': 'vit_huge_patch14_224',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': 'avg',
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': True,
 'cpe_max_size': 1050,
 'model_kwargs': {},
 'teachers': [{'type': 'open_clip',
               'name': 'clip',
               'model': 'ViT-H-14-378-quickgelu',
               'pretrained': 'dfn5b',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 378,
               'amp': True,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'sample_rate': 16,
               'summary_loss_weight': 1.0,
               'fd_loss_weight': 1.0,
               'vitdet_prob': 0.05,
               'vitdet_window_sizes': [3, 9, 9, 9]},
              {'type': 'openai_clip',
               'name': 'openai_clip',
               'model': 'ViT-L/14@336px',
               'pretrained': 'openai',
               'feature_distillation': True,
               'fd_normalize': False,
               'use_summary': False,
               'input_size': 336,
               'amp': False,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'sample_rate': 16,
               'summary_loss_weight': 0.8,
               'fd_loss_weight': 0.8},
              {'type': 'dino_v2',
               'name': 'dino_v2',
               'model': 'dinov2_vitg14',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 224,
               'amp': True,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'sample_rate': 16,
               'summary_loss_weight': 1.0,
               'fd_loss_weight': 1.0}],
 'register_multiple': 8,
 'spectral_reparam': False,
 'model_norm': False,
 'dtype': torch.float32,
 'disable_spectral_reparam': True}
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] Full checkpoint kwargs
[07/18 18:21:41 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:21:41 generate_version_kwargs.py INFO] 
{'aa': None,
 'amp': True,
 'amp_dtype': 'bfloat16',
 'amp_impl': 'native',
 'aug_repeats': 0,
 'aug_splits': 0,
 'auto_loss_balance_mode': 'adaloss',
 'batch_size': 32,
 'bn_eps': None,
 'bn_momentum': None,
 'cache_dir': None,
 'channels_last': False,
 'checkpoint_hist': 10,
 'class_map': '',
 'clip_grad': None,
 'clip_mode': 'norm',
 'cls_token_per_teacher': True,
 'coco_annotations_file': '/datasets/coco2017-adlsa/annotations/captions_val2017.json',
 'coco_image_dir': '/datasets/coco2017-adlsa/val2017',
 'color_jitter': 0.4,
 'cooldown_epochs': 0,
 'cpe_max_size': 1050,
 'crd_loss': False,
 'crd_loss_weight': 0.8,
 'crop_pct': None,
 'cutmix': 0.0,
 'cutmix_minmax': None,
 'data_dir': '/lustre/fsw/portfolios/llmservice/projects/llmservice_nlp_fm/datasets/captioning/datacomp/dc1b/stage2',
 'dataset': 'nvgpt4',
 'dataset_download': False,
 'debug_full_knn': False,
 'decay_epochs': 90,
 'decay_milestones': [90, 180, 270],
 'decay_rate': 0.1,
 'device': 'cuda:0',
 'dist_bn': 'reduce',
 'distributed': True,
 'drop': 0.0,
 'drop_block': None,
 'drop_connect': None,
 'drop_path': None,
 'epoch_repeats': 0.0,
 'epochs': 300,
 'eval': False,
 'eval_metric': 'knn_top1',
 'eval_teacher': False,
 'eval_teacher_only': False,
 'eval_throughput': False,
 'experiment': 'checkpoints',
 'fast_norm': False,
 'feature_summarizer': 'cls_token',
 'feature_upscale_factor': None,
 'fuser': '',
 'gp': 'avg',
 'grad_accum_steps': 1,
 'grad_checkpointing': False,
 'head_init_bias': None,
 'head_init_scale': None,
 'hflip': 0.5,
 'img_size': None,
 'in_chans': None,
 'initial_checkpoint': '',
 'input_size': None,
 'interpolation': '',
 'layer_decay': None,
 'local_rank': 0,
 'log_interval': 50,
 'log_mlflow': False,
 'log_wandb': True,
 'loss': 'cosine',
 'loss_auto_balance': False,
 'lr': 0.001,
 'lr_base': 0.1,
 'lr_base_scale': '',
 'lr_base_size': 256,
 'lr_cycle_decay': 0.5,
 'lr_cycle_limit': 1,
 'lr_cycle_mul': 1.0,
 'lr_k_decay': 1.0,
 'lr_noise': None,
 'lr_noise_pct': 0.67,
 'lr_noise_std': 1.0,
 'mean': None,
 'min_lr': 0,
 'mixup': 0.0,
 'mixup_mode': 'batch',
 'mixup_off_epoch': 0,
 'mixup_prob': 1.0,
 'mixup_switch_prob': 0.5,
 'mlp_hidden_size': 1520,
 'mlp_num_inner': 3,
 'mlp_version': 'v2',
 'model': 'vit_huge_patch14_224',
 'model_ema': False,
 'model_ema_decay': 0.9998,
 'model_ema_force_cpu': False,
 'model_kwargs': {},
 'momentum': 0.9,
 'no_aug': False,
 'no_ddp_bb': False,
 'no_prefetcher': False,
 'no_resume_opt': False,
 'num_classes': None,
 'opt': 'fusedlamb',
 'opt_betas': None,
 'opt_eps': None,
 'opt_kwargs': {},
 'output': '/lustre/fs6/portfolios/llmservice/users/mranzinger/output/evfm/dfn_oai/11-29-23_vit-h-14-cpe_dfn-oai-dino_maxres',
 'patience_epochs': 10,
 'pin_mem': False,
 'prefetcher': True,
 'pretrained': False,
 'rank': 0,
 'ratio': [0.75, 1.3333333333333333],
 'recount': 1,
 'recovery_interval': 0,
 'register_multiple': 8,
 'remode': 'pixel',
 'reprob': 0.0,
 'resplit': False,
 'resume': '/lustre/fs6/portfolios/llmservice/users/mranzinger/output/evfm/dfn_oai/11-29-23_vit-h-14-cpe_dfn-oai-dino_maxres/checkpoints/last.pth.tar',
 'save_images': False,
 'scale': [0.5, 1.0],
 'sched': 'cosine',
 'sched_on_updates': True,
 'seed': 42,
 'smoothing': 0.1,
 'split_bn': False,
 'start_epoch': None,
 'std': None,
 'steps_per_epoch': 2000,
 'sync_bn': False,
 'synchronize_step': False,
 'teachers': [{'amp': True,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'fd_loss_weight': 1.0,
               'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 378,
               'model': 'ViT-H-14-378-quickgelu',
               'name': 'clip',
               'pretrained': 'dfn5b',
               'sample_rate': 16,
               'summary_loss_weight': 1.0,
               'type': 'open_clip',
               'vitdet_prob': 0.05,
               'vitdet_window_sizes': [3, 9, 9, 9]},
              {'amp': False,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'fd_loss_weight': 0.8,
               'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 336,
               'model': 'ViT-L/14@336px',
               'name': 'openai_clip',
               'pretrained': 'openai',
               'sample_rate': 16,
               'summary_loss_weight': 0.8,
               'type': 'openai_clip',
               'use_summary': False},
              {'amp': True,
               'amp_dtype': 'bfloat16',
               'batch_size': 16,
               'fd_loss_weight': 1.0,
               'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 224,
               'model': 'dinov2_vitg14',
               'name': 'dino_v2',
               'sample_rate': 16,
               'summary_loss_weight': 1.0,
               'type': 'dino_v2'}],
 'torchcompile': None,
 'torchscript': False,
 'train_interpolation': 'random',
 'train_split': 'train',
 'tta': 0,
 'use_coco': False,
 'use_multi_epochs_loader': False,
 'val_data_dir': '/lustre/fsw/portfolios/llmservice/projects/llmservice_nlp_fm/datasets/classification/imagenet-1k/webdataset',
 'val_img_size': 378,
 'val_split': 'val',
 'validation_batch_size': 128,
 'vflip': 0.0,
 'wandb_entity': '',
 'wandb_group': 'dfn_oai',
 'wandb_job_type': '',
 'wandb_name': '',
 'wandb_project': '',
 'warmup_epochs': 2.5,
 'warmup_lr': 1e-05,
 'warmup_prefix': False,
 'weight_decay': 2e-05,
 'worker_seeding': 'all',
 'workers': 4,
 'world_size': 64}
[07/18 18:21:41 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------

[07/18 18:22:09 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------
[07/18 18:22:09 generate_version_kwargs.py INFO] Radio Version: e-radio_v2, Model: eradio, Num Params: 389.60M, Verification: SUCCESS
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Resource kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'url': 'https://huggingface.co/nvidia/RADIO/resolve/main/eradio_v2.pth.tar?download=true',
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': {'height': 512, 'width': 512}}
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Conditioner kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'input_scale': 1.0,
 'norm_mean': (0.48145466, 0.4578275, 0.40821073),
 'norm_std': (0.26862954, 0.26130258, 0.27577711),
 'dtype': torch.float32}
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Create model kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'model': 'eradio',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': False,
 'cpe_max_size': None,
 'model_kwargs': {'return_full_features': True},
 'num_teachers': 4,
 'register_multiple': 0,
 'spectral_reparam': False,
 'model_norm': False}
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Radio kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'input_conditioner': InputConditioner(),
 'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=512, width=512),
 'summary_idxs': tensor([0, 1, 2, 3]),
 'window_size': None,
 'adaptors': {}}
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Create radio kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'patch_size': 16,
 'max_resolution': 2048,
 'preferred_resolution': Resolution(height=512, width=512),
 'adaptor_cfgs': None,
 'vitdet_window_size': None,
 'model': 'eradio',
 'in_chans': None,
 'input_size': None,
 'pretrained': False,
 'num_classes': None,
 'drop': 0.0,
 'drop_path': None,
 'drop_block': None,
 'global_pool': None,
 'bn_momentum': None,
 'bn_eps': None,
 'initial_checkpoint': '',
 'torchscript': False,
 'cls_token_per_teacher': False,
 'cpe_max_size': None,
 'model_kwargs': {'return_full_features': True},
 'teachers': [{'type': 'open_clip',
               'name': 'clip',
               'model': 'ViT-H-14-378-quickgelu',
               'pretrained': 'dfn5b',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 378},
              {'type': 'dino_v2',
               'name': 'dino_v2',
               'model': 'dinov2_vitg14_reg',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 224},
              {'type': 'dino_v2',
               'name': 'dino_v2_large',
               'model': 'dinov2_vitl14_reg',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 448},
              {'type': 'sam',
               'name': 'sam',
               'model': 'vit-h',
               'feature_distillation': True,
               'fd_normalize': False,
               'input_size': 1024}],
 'register_multiple': 0,
 'spectral_reparam': False,
 'model_norm': False,
 'dtype': torch.float32,
 'disable_spectral_reparam': True}
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] Full checkpoint kwargs
[07/18 18:22:09 generate_version_kwargs.py INFO] - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
[07/18 18:22:09 generate_version_kwargs.py INFO] 
{'aa': None,
 'amp': True,
 'amp_dtype': 'bfloat16',
 'amp_impl': 'native',
 'aug_repeats': 0,
 'aug_splits': 0,
 'bn_eps': None,
 'bn_momentum': None,
 'cache_dir': None,
 'channels_last': False,
 'checkpoint_hist': 10,
 'chk_keep_forever': 10,
 'class_map': '',
 'clip_grad': None,
 'clip_mode': 'norm',
 'cls_token_per_teacher': False,
 'coco_annotations_file': '/datasets/coco2017-adlsa/annotations/captions_val2017.json',
 'coco_image_dir': '/datasets/coco2017-adlsa/val2017',
 'color_jitter': 0.4,
 'cooldown_epochs': 0,
 'cpe_max_size': None,
 'crd_loss': False,
 'crd_loss_weight': 0.8,
 'crop_pct': None,
 'cutmix': 0.0,
 'cutmix_minmax': None,
 'dataset_download': False,
 'ddp_comm_fp16': False,
 'ddp_comm_power_sgd': False,
 'debug_full_knn': False,
 'decay_epochs': 90,
 'decay_milestones': [90, 180, 270],
 'decay_rate': 0.1,
 'device': 'cuda:0',
 'dist_bn': '',
 'distributed': True,
 'drop': 0.0,
 'drop_block': None,
 'drop_connect': None,
 'drop_path': None,
 'dtype': torch.float32,
 'epoch_repeats': 0.0,
 'eval': False,
 'eval_metric': 'knn_top1',
 'eval_teacher': False,
 'eval_teacher_only': False,
 'eval_throughput': False,
 'fast_norm': False,
 'feature_summarizer': 'cls_token',
 'feature_upscale_factor': None,
 'force_new_wandb_id': False,
 'force_spectral_reparam': False,
 'freeze_bn': False,
 'fuser': '',
 'gp': None,
 'grad_accum_steps': 1,
 'grad_checkpointing': False,
 'head_init_bias': None,
 'head_init_scale': None,
 'head_warmup': 10,
 'hflip': 0.5,
 'img_size': None,
 'in_chans': None,
 'initial_checkpoint': '',
 'input_size': None,
 'interpolation': '',
 'layer_decay': None,
 'local_rank': 0,
 'log_interval': 50,
 'log_mlflow': False,
 'log_wandb': True,
 'loss_auto_balance': False,
 'lr_base': 0.1,
 'lr_base_scale': '',
 'lr_base_size': 256,
 'lr_cycle_decay': 0.5,
 'lr_cycle_limit': 1,
 'lr_cycle_mul': 1.0,
 'lr_k_decay': 1.0,
 'lr_noise': None,
 'lr_noise_pct': 0.67,
 'lr_noise_std': 1.0,
 'mean': None,
 'mesa': False,
 'min_lr': 0,
 'mixup': 0.0,
 'mixup_mode': 'batch',
 'mixup_off_epoch': 0,
 'mixup_prob': 1.0,
 'mixup_switch_prob': 0.5,
 'mlp_hidden_size': 1520,
 'mlp_num_inner': 1,
 'mlp_version': 'v2',
 'model': 'eradio',
 'model_kwargs': {'return_full_features': True},
 'model_norm': False,
 'momentum': 0.9,
 'no_aug': False,
 'no_ddp_bb': False,
 'no_prefetcher': False,
 'no_resume_opt': False,
 'num_classes': None,
 'opt_betas': None,
 'opt_eps': None,
 'patience_epochs': 10,
 'pin_mem': False,
 'prefetcher': True,
 'pretrained': False,
 'rank': 0,
 'ratio': [0.75, 1.3333333333333333],
 'recount': 1,
 'recovery_interval': 0,
 'register_multiple': 0,
 'remode': 'pixel',
 'reprob': 0.0,
 'resplit': False,
 'save_images': False,
 'scale': [0.5, 1.0],
 'sched': 'cosine',
 'seed': 42,
 'smoothing': 0.1,
 'spectral_reparam': False,
 'split_bn': False,
 'start_epoch': None,
 'std': None,
 'sync_bn': True,
 'synchronize_step': True,
 'teachers': [{'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 378,
               'model': 'ViT-H-14-378-quickgelu',
               'name': 'clip',
               'pretrained': 'dfn5b',
               'type': 'open_clip'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 224,
               'model': 'dinov2_vitg14_reg',
               'name': 'dino_v2',
               'type': 'dino_v2'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 448,
               'model': 'dinov2_vitl14_reg',
               'name': 'dino_v2_large',
               'type': 'dino_v2'},
              {'fd_normalize': False,
               'feature_distillation': True,
               'input_size': 1024,
               'model': 'vit-h',
               'name': 'sam',
               'type': 'sam'}],
 'torchcompile': None,
 'torchscript': False,
 'train_interpolation': 'random',
 'train_split': 'train',
 'tta': 0,
 'use_coco': False,
 'use_multi_epochs_loader': False,
 'val_ema_only': False,
 'val_split': 'val',
 'vflip': 0.0,
 'wandb_entity': '',
 'wandb_job_type': '',
 'wandb_name': '',
 'wandb_project': '',
 'warmup_lr': 1e-05,
 'warmup_prefix': False,
 'worker_seeding': 'all',
 'workers': 10,
 'world_size': 64}
[07/18 18:22:09 generate_version_kwargs.py INFO] --------------------------------------------------------------------------------

